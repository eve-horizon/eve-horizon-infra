apiVersion: apps/v1
kind: Deployment
metadata:
  name: eve-orchestrator
  namespace: eve
spec:
  template:
    spec:
      containers:
        - name: orchestrator
          image: public.ecr.aws/w7c4v0w3/eve-horizon/orchestrator:staging
          env:
            - $patch: replace
            - name: DATABASE_URL
              valueFrom:
                secretKeyRef:
                  name: eve-staging-db
                  key: DATABASE_URL
            - name: EVE_API_URL
              value: http://eve-api:4701
            - name: ORCHESTRATOR_PORT
              value: "4702"
            - name: WORKER_URL
              value: http://eve-worker:4749
            - name: EVE_WORKER_URLS
              value: default-worker=http://eve-worker:4749
            - name: EVE_AGENT_RUNTIME_URL
              value: http://eve-agent-runtime:4812
            - name: EVE_AGENT_RUNTIME_URLS
              value: >-
                eve-agent-runtime-0=http://eve-agent-runtime-0.eve-agent-runtime.eve.svc.cluster.local:4812
            - name: WORKSPACE_ROOT
              value: /opt/eve/workspaces
            - name: EVE_MANAGED_DB_RECONCILER_ENABLED
              value: "true"
            - name: EVE_MANAGED_DB_LOCAL_SEED
              value: "true"
